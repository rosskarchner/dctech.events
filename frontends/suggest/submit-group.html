<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Submit a Group - DC Tech Events</title>
  <link rel="stylesheet" href="css/styles.css">
  <meta name="htmx-config" content='{"selfRequestsOnly": false}'>
</head>
<body>
  <header>
    <div class="container">
      <h1><a href="/">Suggest - DC Tech Events</a></h1>
      <nav>
        <a href="submit-event.html">Submit Event</a>
        <a href="submit-group.html">Submit Group</a>
        <a href="my-submissions.html">My Submissions</a>
        <span data-auth="logged-in" class="hidden">
          <a href="#" onclick="DctechAuth.logout(); return false;">Sign out</a>
        </span>
      </nav>
    </div>
  </header>

  <main class="container">
    <h2>Submit a Group to DC Tech Events</h2>
    <p>To submit a group, you'll need to sign in. This allows us to add your group to the calendar.</p>

    <div id="auth-section">
      <div class="auth-status" id="auth-status" data-auth="logged-out">
        <p>Not signed in</p>
        <button class="btn btn-primary" onclick="DctechAuth.login()">Sign In</button>
      </div>
    </div>

    <div id="form-response" class="response-area"></div>

    <form id="group-form" class="hidden" data-auth="logged-in"
          hx-post="https://next.dctech.events/submit"
          hx-target="#form-response"
          hx-swap="innerHTML"
          hx-indicator="#submit-indicator"
          hx-on::after-request="if(event.detail.successful) this.reset()"
      <input type="hidden" name="type" value="group">

      <div class="event-section">
        <h3>Group Details</h3>

        <div class="form-group">
          <label for="name">Group Name <span class="required">*</span></label>
          <input type="text" id="name" name="name" required maxlength="200"
                 placeholder="e.g., DC Python User Group">
        </div>

        <div class="form-group">
          <label for="website">Group Website <span class="required">*</span></label>
          <input type="url" id="website" name="website" required
                 placeholder="https://example.com or https://meetup.com/your-group">
          <small>Main website or Meetup.com page for your group</small>
        </div>

        <div class="form-group">
          <label for="ical">iCal Feed URL</label>
          <input type="url" id="ical" name="ical_url"
                 placeholder="https://example.com/calendar.ics">
          <small>Calendar feed URL (iCal format) - at least one feed type is recommended</small>
        </div>

        <details class="optional-details">
          <summary>Optional Details</summary>
          <div class="optional-fields">
            <div class="form-group">
              <label for="fallback_url">Fallback URL</label>
              <input type="url" id="fallback_url" name="fallback_url"
                     placeholder="https://example.com/events">
              <small>Alternative URL to find events if feeds are unavailable</small>
            </div>
          </div>
        </details>
      </div>

      <div id="status-message" class="status-message"></div>

      <div class="form-actions">
        <button type="submit" id="submit-btn" class="btn btn-primary">
          <span class="htmx-indicator" id="submit-indicator"><span class="spinner"></span></span>
          Submit Group
        </button>
      </div>
    </form>
  </main>

  <script src="https://unpkg.com/htmx.org@2.0.4"></script>
  <script src="js/auth.js"></script>
  <script>
    DctechAuth.requireAuth();
  </script>
</body>
</html>
